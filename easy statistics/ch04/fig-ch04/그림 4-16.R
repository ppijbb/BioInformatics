args = commandArgs()
basename = sub(".R$", "", sub("^--file=(.*/)?", "", args[grep("^--file=", args)]))
if (length(basename) != 0)
    quartz(type="pdf", file=paste0(basename, ".pdf"), width=7, height=4)
par(family="Palatino")
par(mgp=c(1.7,0.7,0)) # title and axis margins. default: c(3,1,0)
par(mar=c(3,3,2,2)) # bottom, left, top, right margins. default: c(5,4,4,2)+0.1
par(mgp=c(1.7,0.7,0)) # title and axis margins. default: c(3,1,0)
par(mar=c(3,3,2,2)) # bottom, left, top, right margins. default: c(5,4,4,2)+0.1

# fcconf = function(x, b) {
#     ret = c(100, 0)
#     for (lambda in seq(b,10,0.001)) {
#         r = dpois(0:100, lambda) / dpois(0:100, pmax(b,0:100))
#         o = order(r, decreasing=TRUE)
#         t = sort(dpois(0:100, lambda), decreasing=TRUE)
#         s = cumsum(dpois(0:100, lambda)[o])
#         m = r[o[sum(s < 0.95) + 1]]
#         if (x %in% (0:100)[r >= m]) {
#             ret[1] = min(ret[1], lambda-b)
#             ret[2] = max(ret[2], lambda-b)
#         }
#     }
#     ret
# }

b = (0:500)/100
# lambda2 = sapply(b, function(x){fcconf(0,x)})[2,]

lambda2 = c( 3.092, 3.082, 3.072, 3.062, 3.052, 3.042, 3.032, 3.022,
3.012, 3.002, 2.992, 2.982, 2.972, 2.962, 2.952, 2.942, 2.932, 2.922,
2.912, 2.902, 2.892, 2.882, 2.872, 2.862, 2.852, 2.842, 2.832, 2.822,
2.812, 2.802, 2.792, 2.782, 2.772, 2.762, 2.752, 2.742, 2.732, 2.722,
2.712, 2.702, 2.693, 2.687, 2.681, 2.675, 2.669, 2.663, 2.657, 2.651,
2.645, 2.638, 2.632, 2.626, 2.62, 2.614, 2.608, 2.602, 2.596, 2.59,
2.584, 2.578, 2.572, 2.566, 2.56, 2.554, 2.548, 2.542, 2.536, 2.53,
2.524, 2.518, 2.512, 2.506, 2.5, 2.494, 2.488, 2.482, 2.476, 2.47,
2.464, 2.458, 2.452, 2.446, 2.44, 2.434, 2.428, 2.422, 2.417, 2.411,
2.405, 2.399, 2.393, 2.387, 2.381, 2.375, 2.369, 2.364, 2.358, 2.352,
2.346, 2.34, 2.334, 2.329, 2.323, 2.317, 2.311, 2.305, 2.3, 2.294,
2.288, 2.282, 2.276, 2.271, 2.265, 2.259, 2.253, 2.248, 2.242, 2.236,
2.23, 2.225, 2.219, 2.213, 2.207, 2.202, 2.196, 2.19, 2.185, 2.179,
2.173, 2.168, 2.162, 2.156, 2.15, 2.145, 2.139, 2.134, 2.128, 2.122,
2.117, 2.111, 2.105, 2.1, 2.094, 2.089, 2.083, 2.077, 2.072, 2.066,
2.061, 2.055, 2.049, 2.044, 2.038, 2.033, 2.027, 2.022, 2.016, 2.011,
2.005, 2, 1.994, 1.989, 1.983, 1.978, 1.972, 1.967, 1.961, 1.956,
1.95, 1.945, 1.939, 1.934, 1.928, 1.923, 1.918, 1.912, 1.907, 1.901,
1.896, 1.891, 1.885, 1.88, 1.874, 1.869, 1.864, 1.858, 1.853, 1.848,
1.842, 1.837, 1.831, 1.826, 1.821, 1.816, 1.81, 1.805, 1.8, 1.794,
1.789, 1.784, 1.778, 1.773, 1.768, 1.763, 1.757, 1.752, 1.747, 1.742,
1.736, 1.731, 1.726, 1.721, 1.716, 1.71, 1.705, 1.7, 1.695, 1.69,
1.684, 1.679, 1.674, 1.669, 1.664, 1.659, 1.654, 1.648, 1.643, 1.638,
1.633, 1.628, 1.623, 1.618, 1.613, 1.608, 1.602, 1.597, 1.592, 1.587,
1.582, 1.577, 1.572, 1.567, 1.562, 1.557, 1.552, 1.547, 1.542, 1.537,
1.532, 1.527, 1.522, 1.517, 1.512, 1.507, 1.502, 1.497, 1.492, 1.488,
1.483, 1.478, 1.473, 1.468, 1.463, 1.458, 1.453, 1.448, 1.443, 1.439,
1.434, 1.774, 1.769, 1.764, 1.759, 1.754, 1.749, 1.744, 1.739, 1.734,
1.729, 1.724, 1.719, 1.714, 1.709, 1.704, 1.699, 1.694, 1.689, 1.684,
1.679, 1.674, 1.669, 1.664, 1.659, 1.654, 1.65, 1.645, 1.64, 1.635,
1.63, 1.625, 1.62, 1.615, 1.611, 1.606, 1.601, 1.596, 1.591, 1.586,
1.582, 1.577, 1.572, 1.567, 1.562, 1.557, 1.553, 1.548, 1.543, 1.538,
1.534, 1.529, 1.524, 1.519, 1.515, 1.51, 1.505, 1.5, 1.496, 1.491,
1.486, 1.482, 1.477, 1.472, 1.468, 1.463, 1.458, 1.453, 1.449, 1.444,
1.44, 1.435, 1.43, 1.426, 1.421, 1.416, 1.412, 1.407, 1.403, 1.398,
1.393, 1.389, 1.384, 1.38, 1.375, 1.371, 1.366, 1.361, 1.357, 1.352,
1.348, 1.343, 1.339, 1.334, 1.33, 1.325, 1.321, 1.316, 1.312, 1.307,
1.303, 1.298, 1.625, 1.621, 1.616, 1.611, 1.607, 1.602, 1.597, 1.593,
1.588, 1.584, 1.579, 1.574, 1.57, 1.565, 1.561, 1.556, 1.551, 1.547,
1.542, 1.538, 1.533, 1.528, 1.524, 1.519, 1.515, 1.51, 1.506, 1.501,
1.497, 1.492, 1.488, 1.483, 1.479, 1.474, 1.47, 1.465, 1.461, 1.456,
1.452, 1.447, 1.443, 1.438, 1.434, 1.429, 1.425, 1.421, 1.416, 1.412,
1.407, 1.403, 1.398, 1.394, 1.39, 1.385, 1.381, 1.377, 1.372, 1.368,
1.363, 1.359, 1.355, 1.35, 1.346, 1.342, 1.337, 1.333, 1.329, 1.324,
1.32, 1.316, 1.312, 1.307, 1.303, 1.299, 1.294, 1.29, 1.286, 1.282,
1.277, 1.273, 1.269, 1.265, 1.261, 1.256, 1.252, 1.248, 1.565, 1.56,
1.556, 1.552, 1.547, 1.543, 1.538, 1.534, 1.53, 1.525, 1.521, 1.516,
1.512, 1.508, 1.503, 1.499, 1.495, 1.49, 1.486, 1.482, 1.477, 1.473,
1.469, 1.464, 1.46, 1.456, 1.451, 1.447, 1.443, 1.439, 1.434, 1.43,
1.426, 1.421, 1.417, 1.413, 1.409, 1.404, 1.4, 1.396, 1.392, 1.387,
1.383, 1.379, 1.375)

plot(b, lambda2, type="l",
     xlab=expression(italic(b)), ylab=expression(italic(Î»)[2] - italic(b)))
dev.off()
